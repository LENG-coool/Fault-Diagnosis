# 可解释性故障診断への新しいパラダイム：
# 熱力学シミュレーション補助ランダムフォレスト(TSRF)

<br>

::: info [**元の出版📜:**](../../public/TSRF.pdf)
*Thermodynamic Simulation-assisted Random Forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines*, **Measurement**, 2025.
:::

## はじめに {#はじめに}
船用ディーゼルエンジンの燃焼室故障診断分野では、エンジニアは長年にわたり3つの重大な課題に直面してきました：
1. **データ不足**：実際の故障サンプルが極めて少なく、深層学習の訓練効果に制限があります。
2. **実装ギャップ**：純粋な物理モデルは計算量が多すぎて、リアルタイム工学応用に適さない場合があります。
3. **「ブラックボックス」ジレンマ**：従来の機械学習モデルは透明性に欠け、検出された故障の物理的メカニズムをたどることが困難です。

これらの問題に対応するため、Measurementに掲載された最近の研究では、革新的で実用的なフレームワークを提案しています。つまり、データフィッティングだけに頼るのではなく、物理シミュレーションを活用して機械学習を補強することです。このアプローチにより、故障診断の説明可能性と信頼性が大幅に向上します。

著者らは、**熱力学シミュレーション補助ランダムフォレスト(TSRF)**を導入しています。これは熱力学メカニズムと説明可能機械学習を橋渡しするフレームワークです。小サンプル環境でも、このアプローチは物理法則との一貫性を保ちながら高い診断精度を実現し、海洋工学に大きな価値をもたらします。

## TSRF フレームワーク{#フレームワーク}
TSRFフレームワークは、1D熱力学モデル、ランダムフォレスト(RF)分類器、SHAP(SHapley Additive exPlanations)インタプリタを統合し、閉ループ診断システムを構築しています。
1. **データ生成と前処理**：正常状態と故障状態の両方をカバーする合成データセットが、1D熱力学シミュレーションを通じて生成されます。
2. **モデル訓練と検証**：ランダムフォレストモデルが前処理されたデータで訓練され、クロスバリデーションによってパフォーマンスが評価されます。
3. **説明可能性分析**：SHAP法を訓練されたモデルに適用し、主要な熱力学パラメータを識別し、診断結果への寄与度を定量化します。
<img src="/ja图片8.png" style="width: 100%; margin: 0 auto; display: block;" />
<p align="center" style="color: grey">熱力学シミュレーション補助ランダムフォレスト(TSRF)フレームワーク</p>

## 1D熱力学モデルの構築と校正{#モデル}
研究の基礎は、燃焼室の熱挙動をシミュレートするために設計された**1D熱力学モデル**です。著者らは実験データに対して綿密なキャリブレーションを実施し、モデルが実際の運転条件下での熱力学特性を正確に反映するようにしました。
<img src="/ja图片7.png"  style="width: 100%; margin: 0 auto; display: block;" />
<p align="center" style="color: grey">1D熱力学モデルの概要図</p>

さらに、モデルは**データ収集モジュール(DCM)**を通じて取得した現地データを使用して校正されます。これにより、シミュレーション出力が実際のエンジン運転で観察される主要な熱力学パラメータと一致していることを保証します。
<img src="/ja图片6.png" style="width: 60%; margin: 0 auto; display: block;" />
<p align="center" style="color: grey">データ収集モジュール(DCM)</p>

## 物理モデリングと典型的故障のシミュレーション{#故障建模}
校正後、著者らは主要なパラメータに対象的な擾動を導入して、5つの典型的な燃焼室故障をシミュレートしました。各故障は明確な物理メカニズムで支えられています。
| 故障ID | 故障タイプ  | 物理的メカニズム                  | 主要パラメータの調整                       |
| ---- | ----- | ---------------------- | ---------------------------- |
| F1   | シリンダーヘッドクラック  | 熱機械的負荷がひび割れを引き起こし、構造/冷却が劣化します。 | ヘッド温度(TH)を346°Cに上昇         |
| F2   | ピストン侵食  | 材料劣化により熱侵食とブローバイが増加します。         | ピストン温度(TP)を上昇 + わずかなブローバイ(0.01 kg/s) |
| F3   | シリンダーライナー磨耗  | 磨粒が幾何学的変形とシール破損を引き起こします。      | ボア直径を増加 + 大量のブローバイ(0.03 kg/s)       |
| F4   | ピストンリング磨耗 | 磨耗によるシール劣化がブローバイフィードバックループを生成します。     | ブローバイ質量流量を調整(0.02 kg/s)          |
| F5   | ピストンリング固着 | カーボン堆積、潤滑不足、スラッジ蓄積。           | ボア直径を調整 + ライナー温度を上昇 + ブローバイ           |

このメカニズム駆動型モデリングにより、機械学習の「グラウンドトゥルース」として機能する高品質で包括的なデータセットが生成されます。

## RF と SHAP による特徴選択{#特徴筛选}
データセットが確立されると、**ランダムフォレスト(RF)**アルゴリズムが主要な分類器として採用されます。「ブラックボックス」問題を解決するため、著者らは**SHAP**分析を導入して、モデルの意思決定プロセスに深い洞察を提供します。

特徴選択は2段階の戦略に従います：

1. RF による初期識別：
- RFは熱力学パラメータと故障タイプ間のマッピングを学習します。
- 予測スコアに基づいて各パラメータの限界貢献が計算されます。

2. Tree SHAP による定量分析：
- 各パラメータのSHAP値が計算されます。
- 特徴は SHAP 重みに基づいてフィルタリングされ、診断への影響が最も高く、物理的意義が最も明確なものを優先します。

## 実験結果とパフォーマンス評価{#実験結果}
実験的検証により、TSRFフレームワークの有効性が実証されました。小サンプル環境下でも、このアプローチは95%以上の診断精度を達成し、従来のブラックボックスモデルを大幅に上回ります。

さらに、SHAP分析は異なる故障タイプ間での熱力学パラメータの重要度分布を成功裏に明らかにします。これにより、エンジニアは根本原因分析(RCA)の信頼できるリファレンスを得られ、単純な分類結果を実行可能な物理的洞察に変えることができます。